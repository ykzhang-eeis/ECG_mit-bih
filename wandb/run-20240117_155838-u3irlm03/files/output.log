

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.51it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.33it/s]
 43%|████████████████████████████████████████████████████████████████████▏                                                                                          | 6/14 [00:02<00:02,  2.67it/s]
Epoch [1m1[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.62it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.59it/s]
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                | 43/48 [00:10<00:01,  3.46it/s]
Epoch [1m2[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.22it/s]
 21%|██████████████████████████████████                                                                                                                             | 3/14 [00:01<00:03,  2.90it/s]
Epoch [1m3[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.77it/s]






100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:12<00:00,  3.90it/s]
 29%|█████████████████████████████████████████████▍                                                                                                                 | 4/14 [00:01<00:04,  2.31it/s]
Epoch [1m4[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.63it/s]





100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.19it/s]
 14%|██████████████████████▋                                                                                                                                        | 2/14 [00:00<00:04,  2.81it/s]
Epoch [1m5[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.71it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:10<00:00,  4.51it/s]
 21%|██████████████████████████████████                                                                                                                             | 3/14 [00:01<00:04,  2.53it/s]
Epoch [1m6[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.61it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:10<00:00,  4.42it/s]
 14%|██████████████████████▋                                                                                                                                        | 2/14 [00:00<00:05,  2.33it/s]
Epoch [1m7[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.65it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.07it/s]

 36%|████████████████████████████████████████████████████████▊                                                                                                      | 5/14 [00:01<00:03,  2.57it/s]
Epoch [1m8[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.68it/s]





100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.11it/s]
 14%|██████████████████████▋                                                                                                                                        | 2/14 [00:00<00:05,  2.22it/s]
Epoch [1m9[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.60it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.16it/s]
  0%|                                                                                                                                                                       | 0/14 [00:00<?, ?it/s]
Epoch [1m10[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.63it/s]





100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:11<00:00,  4.25it/s]
 29%|█████████████████████████████████████████████▍                                                                                                                 | 4/14 [00:01<00:03,  2.54it/s]
Epoch [1m11[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:05<00:00,  2.61it/s]





100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 48/48 [00:10<00:00,  4.42it/s]
 21%|██████████████████████████████████                                                                                                                             | 3/14 [00:01<00:04,  2.65it/s]
Epoch [1m12[22m/[1m50[22m, Train Loss: [1m0.021660858765244484[22m, Train F1: [1m0.09675967596759676
Test Loss: [1m0.1732867956161499[22m, Test F1: [1m0.09916492693110648
Precision: [1m0.061848958333333336[22m, Recall: [1m0.25[22m, ACC: [1m0.24739583333333334
[1m[[[22m [1m95[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[[22m [1m96[22m   [1m0[22m   [1m0[22m   [1m0]
 [1m[101[22m   [1m0[22m   [1m0[22m   [1m0]
 29%|█████████████████████████████████████████████▍                                                                                                                 | 4/14 [00:01<00:04,  2.47it/s][34m[1mwandb[39m[22m: Ctrl + C detected. Stopping sweep.
 29%|█████████████████████████████████████████████▍                                                                                                                 | 4/14 [00:01<00:04,  2.24it/s]
Traceback (most recent call last):
  File "/home/zyk/Personal_study_projects/ECG_mit-bih/main.py", line 36, in train
    train_snn_model(model, train_dataloader, test_dataloader, config)
  File "/home/zyk/Personal_study_projects/ECG_mit-bih/train.py", line 28, in train_snn_model
    train_loss, train_f1 = run_epoch(train_dataloader, model, criterion, optimizer, device, train=True)
  File "/home/zyk/Personal_study_projects/ECG_mit-bih/train.py", line 66, in run_epoch
    outputs, _, _ = model(batch, record=True)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/torch/torch_module.py", line 143, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/module.py", line 643, in __call__
    outputs, new_state, recorded_state = self.evolve(
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/combinators/sequential.py", line 127, in evolve
    x, substate, subrec = mod(x, record=record)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/torch/torch_module.py", line 143, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/module.py", line 643, in __call__
    outputs, new_state, recorded_state = self.evolve(
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/torch/lif_torch.py", line 454, in evolve
    output_data, _, _ = super().evolve(input_data, record)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/torch/torch_module.py", line 178, in evolve
    output_data = nn.Module.__call__(self, input_data)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zyk/anaconda3/envs/ecg/lib/python3.8/site-packages/rockpool/nn/modules/torch/lif_torch.py", line 693, in forward
    isyn *= self.beta.to(isyn.device)
Exception